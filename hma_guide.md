# HMA+만트라 자동매매 신호 분석 가이드

## 1. 실행 옵션 (hma.sh)

### 실행 예시
```bash
./hma.sh -s AAPL -p 5 -i 1m -r True
```

### 옵션 설명
| 옵션 | 설명 |
|------|------------------------------------------------------|
| -s   | 분석할 종목코드 (예: AAPL, TSLA, MSFT 등)            |
| -p   | 분석 기간(일 단위, 예: 5, 30, 120 등)                |
| -i   | 데이터 간격 (1m=1분봉, 5m=5분봉, 1d=일봉 등)         |
| -r   | 프리마켓/애프터마켓 데이터 포함 여부 (True/False)     |

- 미국 주식만 분봉/프리마켓 데이터가 지원됩니다.
- 한국 주식은 일봉만 지원되며, 분봉/프리마켓 옵션은 무시됩니다.
- 분석 결과 이미지는 `output/hma_mantra/<종목코드>/<종목코드>_hma_mantra_md_signals.png`에 저장됩니다.

---

## 2. 매수/매도 신호 조건 정의

### 매수 신호
- **B1**: 종가가 HMA를 상향 돌파하고, 타지마할 RSI가 매수 구간(rsi3 ≥ rsi14)인 경우
- **B2**: 전일 종가 < 밴드 하단, 당일 종가 ≥ 밴드 하단이고, 타지마할 RSI가 매수 구간(rsi3 ≥ rsi14)인 경우
- **B3**: 종가가 HMA를 상향 돌파하고, 타지마할 RSI가 매수 구간이 아니며(rsi3 < rsi14), MACD가 매수 구간(macd > signal)인 경우 (항상 일반 매수로 표시)

### 매도 신호
- **T1**: 종가가 HMA를 하향 돌파하고, 타지마할 RSI가 매도 구간(rsi3 < rsi14)인 경우
- **T2**: 전일 종가 > 밴드 상단, 당일 종가 < 밴드 상단이고, 타지마할 RSI가 매도 구간(rsi3 < rsi14)인 경우

### 강한/일반 신호 구분
- **강한 매수(▲, 진한 파랑)**: 매수 신호(B1, B2) + MACD > Signal
- **일반 매수(▲, 연한 파랑)**: 매수 신호(B1, B2, B3) + MACD ≤ Signal 또는 B3 신호
- **강한 매도(▼, 진한 빨강)**: 매도 신호(T1, T2) + MACD < Signal
- **일반 매도(▼, 연한 빨강)**: 매도 신호(T1, T2) + MACD ≥ Signal

---

## 3. 사용된 차트 및 서브플롯 설명

- **메인 차트**: 캔들차트, HMA, 만트라 밴드, 볼린저 밴드, 신호 마커(매수/매도), 박스권, 기준선, 신호 근거/강도 범례
- **타지마할 RSI**: RSI(3, 14, 50) 및 매수/매도 구간, 교차점 dot 표시
- **MACD**: MACD, Signal, Histogram, 매수/매도 구간 배경, MACD 신호 마커
- **거래량**: 일별 거래량, (한국 주식의 경우) 외국인 매수/매도/순매수 거래량
- **VIX**: 변동성지수(VIX) 및 구간별 색상 가이드
- **10년물 금리**: 미국 10년물 국채 금리
- **달러인덱스**: DXY(달러인덱스)
- **금가격**: GOLD(국제 금 선물 가격)

---

추가 문의사항이 있으면 언제든 말씀해 주세요! 